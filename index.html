<!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Su gimimo diena, Ugne!</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@900&family=Permanent+Marker&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r160/three.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body, html {
            height: 100%;
            width: 100%;
            overflow: hidden;
            background: radial-gradient(circle at 30% 20%, #fffdf8 0%, #ffe8f0 45%, #ffd8ea 100%);
            font-family: 'Montserrat', sans-serif;
        }

        .background-notes {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        .sticky-note {
            position: absolute;
            width: 90px;
            height: 90px;
            padding: 10px;
            font-family: 'Permanent Marker', cursive;
            font-size: 0.8rem;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            box-shadow: 3px 3px 8px rgba(0, 0, 0, 0.15);
            border-bottom-right-radius: 20px 5px;
        }

        .center-message {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            text-align: center;
            background: rgba(255, 255, 255, 0.94);
            backdrop-filter: blur(3px);
            padding: 25px;
            border-radius: 30px;
            border: 4px solid #ff7eb9;
            width: 85%;
            max-width: 350px;
            box-shadow: 0 14px 40px rgba(175, 62, 114, 0.22);
        }

        .highlight {
            color: #ff4081;
            display: block;
            font-size: clamp(2.4rem, 7vw, 3rem);
            margin-top: 5px;
        }

        #walker {
            position: fixed;
            left: 0;
            bottom: 8px;
            width: clamp(150px, 22vw, 220px);
            aspect-ratio: 22 / 30;
            z-index: 25;
            pointer-events: none;
            will-change: transform;
        }

        #walker-canvas {
            width: 100%;
            height: 100%;
            display: block;
            filter: drop-shadow(0 12px 10px rgba(80, 38, 54, 0.24));
        }
    </style>
</head>
<body>
    <div id="notes-container" class="background-notes"></div>

    <div class="center-message">
        <h1>Su gimimo diena, <span class="highlight">UGNE!</span></h1>
    </div>

    <div id="walker" aria-hidden="true">
        <canvas id="walker-canvas"></canvas>
    </div>

    <script>
        const wishes = [
            "Laim\u0117s!",
            "Meil\u0117s!",
            "\u0160ypsen\u0173!",
            "S\u0117km\u0117s!",
            "Nuotyki\u0173!",
            "Svajoni\u0173!",
            "\u0160viesos!",
            "Juoko!",
            "Tikrumo!",
            "Laisv\u0117s!"
        ];
        const colors = ["#ffb7b2", "#ffdac1", "#e2f0cb", "#b5ead7", "#c7ceea"];

        function setupNotes() {
            const container = document.getElementById("notes-container");
            for (let i = 0; i < 8; i += 1) {
                const note = document.createElement("div");
                note.className = "sticky-note";
                note.innerText = wishes[i % wishes.length];
                note.style.backgroundColor = colors[i % colors.length];
                note.style.left = `${Math.random() * 70 + 5}%`;
                note.style.top = `${Math.random() * 70 + 5}%`;
                note.style.transform = `rotate(${Math.random() * 20 - 10}deg)`;
                container.appendChild(note);
                gsap.to(note, {
                    y: -10,
                    rotation: "+=5",
                    duration: 2 + Math.random(),
                    repeat: -1,
                    yoyo: true,
                    ease: "sine.inOut"
                });
            }
        }

        const walker = document.getElementById("walker");
        let direction = 1;
        let travelTween = null;
        let threeRig = null;

        function setup3DWalker() {
            const canvas = document.getElementById("walker-canvas");
            const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
            renderer.setPixelRatio(Math.min(window.devicePixelRatio || 1, 2));
            renderer.outputColorSpace = THREE.SRGBColorSpace;

            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(28, 1, 0.1, 30);
            camera.position.set(0, 1.82, 5.8);

            const hemiLight = new THREE.HemisphereLight(0xfff4ec, 0xffc6de, 1.12);
            const keyLight = new THREE.DirectionalLight(0xffffff, 1.35);
            keyLight.position.set(3.1, 4.8, 3.6);
            const fillLight = new THREE.DirectionalLight(0xffd2e4, 0.62);
            fillLight.position.set(-2.4, 2.2, 2.1);
            scene.add(hemiLight, keyLight, fillLight);

            const matSkin = new THREE.MeshStandardMaterial({ color: 0xffdcc7, roughness: 0.45, metalness: 0.03 });
            const matHair = new THREE.MeshStandardMaterial({ color: 0xf4ca78, roughness: 0.52, metalness: 0.04 });
            const matCardigan = new THREE.MeshStandardMaterial({ color: 0xff97bf, roughness: 0.58, metalness: 0.02 });
            const matSkirt = new THREE.MeshStandardMaterial({ color: 0xf7e5d2, roughness: 0.68, metalness: 0.01 });
            const matDark = new THREE.MeshStandardMaterial({ color: 0x2a2e44, roughness: 0.43, metalness: 0.08 });
            const matEye = new THREE.MeshStandardMaterial({ color: 0x4f78d8, roughness: 0.25, metalness: 0.08 });
            const matShoe = new THREE.MeshStandardMaterial({ color: 0x704833, roughness: 0.57, metalness: 0.06 });

            const avatar = new THREE.Group();
            avatar.rotation.y = -0.12;
            scene.add(avatar);

            const torsoCore = new THREE.Mesh(new THREE.CylinderGeometry(0.35, 0.38, 1.0, 24), matCardigan);
            torsoCore.position.set(0, 1.56, 0);
            torsoCore.scale.z = 0.72;
            avatar.add(torsoCore);

            const chest = new THREE.Mesh(new THREE.SphereGeometry(0.36, 24, 18), matCardigan);
            chest.position.set(0, 1.93, 0);
            chest.scale.set(1.05, 0.78, 0.72);
            avatar.add(chest);

            const blouse = new THREE.Mesh(new THREE.CylinderGeometry(0.24, 0.3, 0.58, 20), matSkirt);
            blouse.position.set(0, 1.54, 0.28);
            blouse.scale.z = 0.42;
            avatar.add(blouse);

            const skirt = new THREE.Mesh(new THREE.ConeGeometry(0.47, 0.62, 28), matSkirt);
            skirt.position.set(0, 1.0, 0);
            avatar.add(skirt);

            const matSock = new THREE.MeshStandardMaterial({ color: 0xfaf4f0, roughness: 0.72, metalness: 0 });
            const legLPivot = new THREE.Group();
            legLPivot.position.set(-0.19, 0.98, 0);
            const legRPivot = new THREE.Group();
            legRPivot.position.set(0.19, 0.98, 0);
            avatar.add(legLPivot, legRPivot);

            function createLeg() {
                const leg = new THREE.Group();
                const shin = new THREE.Mesh(new THREE.CylinderGeometry(0.105, 0.1, 1.06, 16), matSkin);
                shin.position.y = -0.53;
                const sock = new THREE.Mesh(new THREE.CylinderGeometry(0.11, 0.115, 0.18, 14), matSock);
                sock.position.y = -1.02;
                const shoe = new THREE.Mesh(new THREE.SphereGeometry(0.2, 18, 14), matShoe);
                shoe.position.set(0, -1.14, 0.14);
                shoe.scale.set(1.15, 0.72, 1.65);
                leg.add(shin, sock, shoe);
                return leg;
            }

            legLPivot.add(createLeg());
            legRPivot.add(createLeg());

            const armLPivot = new THREE.Group();
            armLPivot.position.set(-0.44, 1.96, 0.06);
            const armRPivot = new THREE.Group();
            armRPivot.position.set(0.44, 1.96, 0.06);
            avatar.add(armLPivot, armRPivot);

            function createArm() {
                const arm = new THREE.Group();
                const upper = new THREE.Mesh(new THREE.CylinderGeometry(0.09, 0.085, 0.86, 16), matCardigan);
                upper.position.y = -0.43;
                const hand = new THREE.Mesh(new THREE.SphereGeometry(0.1, 14, 12), matSkin);
                hand.position.y = -0.87;
                arm.add(upper, hand);
                return arm;
            }

            armLPivot.add(createArm());
            armRPivot.add(createArm());

            const headPivot = new THREE.Group();
            headPivot.position.set(0, 2.64, 0.07);
            avatar.add(headPivot);

            const head = new THREE.Mesh(new THREE.SphereGeometry(0.5, 34, 28), matSkin);
            headPivot.add(head);

            const hairBack = new THREE.Mesh(new THREE.SphereGeometry(0.56, 32, 24), matHair);
            hairBack.position.set(0, -0.2, -0.06);
            hairBack.scale.set(1.08, 1.45, 1.08);
            headPivot.add(hairBack);

            const bangs = new THREE.Mesh(new THREE.SphereGeometry(0.43, 26, 20), matHair);
            bangs.position.set(0, 0.13, 0.31);
            bangs.scale.set(1.05, 0.62, 0.42);
            headPivot.add(bangs);

            const lockL = new THREE.Mesh(new THREE.CylinderGeometry(0.08, 0.06, 0.9, 12), matHair);
            lockL.position.set(-0.42, -0.58, 0.18);
            lockL.rotation.z = 0.12;
            const lockR = lockL.clone();
            lockR.position.x = 0.42;
            lockR.rotation.z = -0.12;
            headPivot.add(lockL, lockR);

            const bow = new THREE.Mesh(new THREE.SphereGeometry(0.11, 16, 12), matCardigan);
            bow.position.set(0.34, 0.1, -0.22);
            bow.scale.set(1.7, 0.72, 1);
            headPivot.add(bow);

            const eyeGeo = new THREE.SphereGeometry(0.064, 14, 12);
            const eyeL = new THREE.Mesh(eyeGeo, matEye);
            eyeL.position.set(-0.145, 0.02, 0.45);
            const eyeR = new THREE.Mesh(eyeGeo, matEye);
            eyeR.position.set(0.145, 0.02, 0.45);
            const glintMat = new THREE.MeshStandardMaterial({ color: 0xffffff, roughness: 0.2, metalness: 0 });
            const eyeGlintL = new THREE.Mesh(new THREE.SphereGeometry(0.018, 10, 8), glintMat);
            eyeGlintL.position.set(-0.126, 0.055, 0.5);
            const eyeGlintR = eyeGlintL.clone();
            eyeGlintR.position.x = 0.16;
            headPivot.add(eyeL, eyeR, eyeGlintL, eyeGlintR);

            const mouth = new THREE.Mesh(new THREE.TorusGeometry(0.06, 0.009, 8, 20, Math.PI), new THREE.MeshStandardMaterial({
                color: 0xe07b98,
                roughness: 0.48,
                metalness: 0
            }));
            mouth.rotation.z = Math.PI;
            mouth.position.set(0, -0.13, 0.46);
            headPivot.add(mouth);

            const glassesMat = new THREE.MeshStandardMaterial({ color: 0x262b41, roughness: 0.36, metalness: 0.2 });
            const frameL = new THREE.Mesh(new THREE.TorusGeometry(0.118, 0.012, 12, 28), glassesMat);
            frameL.position.set(-0.145, 0.02, 0.49);
            const frameR = frameL.clone();
            frameR.position.x = 0.145;
            const bridge = new THREE.Mesh(new THREE.BoxGeometry(0.065, 0.012, 0.012), glassesMat);
            bridge.position.set(0, 0.02, 0.49);
            headPivot.add(frameL, frameR, bridge);

            const blushMat = new THREE.MeshStandardMaterial({ color: 0xf4abc0, roughness: 0.7, metalness: 0 });
            const blushL = new THREE.Mesh(new THREE.SphereGeometry(0.045, 12, 10), blushMat);
            blushL.position.set(-0.245, -0.09, 0.44);
            blushL.scale.set(1.35, 0.65, 0.5);
            const blushR = blushL.clone();
            blushR.position.x = 0.245;
            headPivot.add(blushL, blushR);

            const matBag = new THREE.MeshStandardMaterial({ color: 0x9f633f, roughness: 0.6, metalness: 0.08 });
            const strap = new THREE.Mesh(new THREE.CylinderGeometry(0.025, 0.025, 1.55, 12), matBag);
            strap.position.set(-0.02, 1.46, 0.28);
            strap.rotation.z = -0.74;
            strap.rotation.y = 0.18;
            avatar.add(strap);

            const bag = new THREE.Mesh(new THREE.BoxGeometry(0.52, 0.42, 0.26), matBag);
            bag.position.set(0.56, 0.95, 0.3);
            avatar.add(bag);

            const bagFlap = new THREE.Mesh(new THREE.BoxGeometry(0.5, 0.22, 0.12), new THREE.MeshStandardMaterial({
                color: 0xb47a55,
                roughness: 0.62,
                metalness: 0.06
            }));
            bagFlap.position.set(0.56, 1.04, 0.38);
            avatar.add(bagFlap);

            const cameraRig = new THREE.Group();
            cameraRig.position.set(0, 1.56, 0.5);
            avatar.add(cameraRig);
            const cameraBody = new THREE.Mesh(new THREE.BoxGeometry(0.45, 0.3, 0.25), matDark);
            const lens = new THREE.Mesh(new THREE.CylinderGeometry(0.082, 0.1, 0.14, 18), new THREE.MeshStandardMaterial({
                color: 0x4f628f,
                roughness: 0.2,
                metalness: 0.35
            }));
            lens.rotation.x = Math.PI / 2;
            lens.position.z = 0.17;
            cameraRig.add(cameraBody, lens);

            const groundShadow = new THREE.Mesh(
                new THREE.CircleGeometry(0.8, 32),
                new THREE.MeshBasicMaterial({ color: 0x4e2f39, transparent: true, opacity: 0.2 })
            );
            groundShadow.rotation.x = -Math.PI / 2;
            groundShadow.position.set(0, -0.12, 0);
            avatar.add(groundShadow);

            function resizeCanvas() {
                const width = Math.max(160, walker.clientWidth);
                const height = Math.max(200, walker.clientHeight);
                renderer.setSize(width, height, false);
                camera.aspect = width / height;
                camera.updateProjectionMatrix();
            }

            resizeCanvas();

            let lastTime = performance.now();
            let phase = 0;
            function render(now) {
                const delta = Math.min((now - lastTime) / 1000, 0.05);
                lastTime = now;
                phase += delta * 6.1;
                const swing = Math.sin(phase);
                const sway = Math.sin(phase * 0.5);

                legLPivot.rotation.x = swing * 0.43;
                legRPivot.rotation.x = -swing * 0.43;
                armLPivot.rotation.x = -1.05 - swing * 0.08;
                armRPivot.rotation.x = -1.05 + swing * 0.08;
                armLPivot.rotation.z = 0.35 + sway * 0.03;
                armRPivot.rotation.z = -0.35 - sway * 0.03;
                headPivot.rotation.z = sway * 0.03;
                hairBack.rotation.x = 0.09 - swing * 0.04;
                avatar.position.y = Math.sin(phase * 2) * 0.03;
                cameraRig.position.y = 1.56 + Math.sin(phase * 2 + 0.65) * 0.016;
                groundShadow.scale.setScalar(0.94 - Math.sin(phase * 2) * 0.045);

                renderer.render(scene, camera);
                requestAnimationFrame(render);
            }

            requestAnimationFrame(render);
            threeRig = { resize: resizeCanvas };
        }

        function walkAcrossPage() {
            if (travelTween) travelTween.kill();

            const width = window.innerWidth;
            const characterWidth = walker.offsetWidth || 160;
            const margin = 30;
            const startX = direction === 1 ? -characterWidth - margin : width + margin;
            const endX = direction === 1 ? width + margin : -characterWidth - margin;
            const distance = Math.abs(endX - startX);
            const speed = 105;
            const duration = Math.max(6, distance / speed);

            gsap.set(walker, {
                x: startX,
                scaleX: direction === 1 ? 1 : -1
            });

            travelTween = gsap.to(walker, {
                x: endX,
                duration,
                ease: "none",
                onComplete: () => {
                    direction *= -1;
                    walkAcrossPage();
                }
            });
        }

        setupNotes();
        setup3DWalker();
        walkAcrossPage();
        window.addEventListener("resize", () => {
            if (threeRig) threeRig.resize();
            walkAcrossPage();
        });
    </script>
</body>
</html>
